<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/static/css/face.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Redressed&display=swap" rel="stylesheet">
  <title>Digital Divination</title>
  <script src="/static/js/backgroundSize.js"></script>
</head>

<body>
  <img class="bgimage" id="bgimageid" src="../static/images/null.png" alt="">
  <nav class="navbar navbar-expand-lg navbar-dark mb-5" style="background-color:rgb(174, 46, 46); height: 45px;">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">RLST121</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown"
        aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNavDropdown">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" aria-current="page" href="/">Home</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle active" href="#" id="navbarDropdownMenuLink" role="button"
              data-bs-toggle="dropdown" aria-expanded="false">
              Tests
            </a>
            <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
              <li><a class="dropdown-item" href="/mbti">MBTI</a></li>
              <li><a class="dropdown-item active" href="/facereader" style="background-color:rgb(174, 46, 46);">Face
                  Reader 관상</a></li>
              <li><a class="dropdown-item" href="/sajupalja">SajuPalja 사주팔자</a></li>
            </ul>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/survey">Survey</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/summary">Summary</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <div class="container text-center" id="project_title">
    <h1>Face Reader Test</h1>
    <hr>
  </div>
  <div class="container" style="position: relative;">
    <article class="mt-4 fr_explanation text-center start">
      <h4 class="mt-5 mb-3" style="font-weight: bold;">What is Face Reading?</h4>
      <h5 class=" double-space">Face Reading (관상), meaning physiognomy, is a Korean concept that refers to the prediction of fortunes using facial features, just as one would do with a palm reading. Though the younger generation generally pays little attention to the custom, people from older generations still regularly use gwansang to tell their fortune or determine their compatibility with another person. In fact, some companies went as far as to have a physiognomist during their interview to evaluate whether the candidate befits the company. The companies appraised the distance between eyes or eyebrows, the shape of the nose, the balance of the face, etc. to find bad or good omens of the interviewee. <br> <a href="http://herald.kaist.ac.kr">For more info & Link to source (The KAIST Herald)</a>
      </h5>
      <h4 class="mt-5 mb-3" style="font-weight: bold;">Jinny's Animal-Face Reading Test!!!</h4>
      <h5 class=" double-space">Have you heard of the terms "고양이상 (cat-face)" "강아지상 (puppy-face)" "원숭이상 (monkey-face)" "공룡상 (dino-face)" etc? In Korea, it's common to classify people's faces into cat-faces or puppy-faces based on the shapes and the ratio of eyes, nose, mouth, and facial lines. Some examples of Korean female actresses and K-pop idols categorized into these cat/puppy-faces can be seen from <a href="https://blog.trazy.com/cat-face-or-puppy-face-korean-celebrities/#:~:text=In%20Korea%2C%20it's%20common%20to,actresses%20and%20K%2Dpop%20idols.">HERE</a>. <br>
      For the Face Reading test, I initially planned to create a test where I categorize faces based on Physiognomy (관상학), but 관상학 was extremely complicated and there was no open-source database I could use. Instead, I decided to use machine learning and AI to create a simple face-match test on animal faces. I created my own database using Google images on animal faces, and trained my machine learning model with Teachable Machines.<br> <a href="https://teachablemachine.withgoogle.com/models/Z8FVUFcT4/">Link to my Trained Machine Model</a>
      </h5>
      
      <div class="mb-5 mt-5 row">
        <section class="col-2"></section>
        <button type="button" class="mx-1 btn btn-light col-4"
          style="font-size: larger; font-weight: bold; border: 2px solid black; background-color: rgb(174, 46, 46); color: white;"
          onclick="startweb();">CLICK HERE TO START TEST <br>WITH WEB CAM</button>
        <button type="button" class="mx-1 btn btn-light col-4"
          style="font-size: larger; font-weight: bold; border: 2px solid black; background-color: rgb(174, 46, 46); color: white;"
          onclick="startupload();">CLICK HERE TO START TEST<br>WITH IMG UPLOAD</button>
      </div>
    </article>
    <article class="mt-4 fr_explanation faceweb ">
      <section class="ms-5">
        <h4 class="mt-5 mb-3" style="font-weight: bold;">Instructions</h4>
        <ol style="font-size:large;">
          <li>Click Allow Web Cam Button</li>
          <li>Allow Web Cam on Browser</li>
          <li>Wait for web cam to activate</li>
        </ol>
      </section>
      <button type="button" class="ms-5 btn btn-light col-4"
        style="font-size: larger; font-weight: bold; border: 2px solid black; background-color: rgb(174, 46, 46); color: white;"
        onclick="initweb();">ALLOW WEB CAM</button>
      <section class="mx-5 mb-5">
        <div id="webcam-container" class="mt-5"></div>
        <div id="label-container"></div>
      </section>
    </article>
    <article class="mt-4 fr_explanation faceupload">
      <section class="ms-5">
        <h4 class="mt-5 mb-3" style="font-weight: bold;">Instructions</h4>
        <ol style="font-size:large;">
          <li>Click TRAIN MODEL</li>
          <li>Add your face image</li>
          <li>Click PREDICT WITH MY IMAGE (don't forget to click TRAIN MODEL first)</li>
          <li>Wait for prediction to show up (you might have to reclick/retry)</li>
        </ol>
      </section>
      <button type="button" class="mx-1 btn btn-light col-4 mt-3"
        style="font-size: larger; font-weight: bold; border: 2px solid black; background-color: rgb(174, 46, 46); color: white;"
        onclick="initupload();">TRAIN MODEL</button>
      <section class="ms-5">
        <div id="webcam-container" class="mt-3"></div>
      </section>
      <script class="jsbin" src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
      <div class="ms-1 row">
        <!-- <section class="col-2"></section> -->
        <div class="file-upload col-6">
          <button class="file-upload-btn" type="button" onclick="$('.file-upload-input').trigger( 'click' )">Add
            Image</button>
  
          <div class="image-upload-wrap">
            <input class="file-upload-input" type='file' onchange="readURL(this);" accept="image/*" />
            <div class="drag-text">
              <h3>Drag and drop a file or select add Image</h3>
            </div>
          </div>
          <div class="file-upload-content">
            <img class="file-upload-image" id="face-img" src="#" alt="your image" />
            <div class="image-title-wrap">
              <button type="button" onclick="removeUpload()" class="remove-image">Remove <span
                  class="image-title">Uploaded Image</span></button>
            </div>
          </div>
        </div>
        <section class="col-6 removethis"></section>
        <div id="label-container-upload" class="col-6"></div>
      </div>
      <button type="button" class="mx-1 btn btn-light col-4 mb-5 mb-5 mt-3"
      style="font-size: larger; font-weight: bold; border: 2px solid black; background-color: rgb(174, 46, 46); color: white;"
      onclick="predictupload()">PREDICT WITH MY IMAGE</button>
      
      
    </article>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js"></script>
  <script type="text/javascript">
    // More API functions here:
    // https://github.com/googlecreativelab/teachablemachine-community/tree/master/libraries/image

    // the link to your model provided by Teachable Machine export panel
    const URL = "https://teachablemachine.withgoogle.com/models/Z8FVUFcT4/";

    let model, webcam, labelContainer, maxPredictions;

    // Load the image model and setup the webcam
    async function initupload() {
      const modelURL = URL + "model.json";
      const metadataURL = URL + "metadata.json";

      // load the model and metadata
      // Refer to tmImage.loadFromFiles() in the API to support files from a file picker
      // or files from your local hard drive
      // Note: the pose library adds "tmImage" object to your window (window.tmImage)
      model = await tmImage.load(modelURL, metadataURL);
      maxPredictions = model.getTotalClasses();
      labelContainer = document.getElementById("label-container-upload");
      for (let i = 0; i < maxPredictions; i++) { // and class labels
        labelContainer.appendChild(document.createElement("div"));
      }
    }
    async function predictupload() {
      // predict can take in an image, video or canvas html element
      var imgupload = document.getElementById("face-img");
      const prediction = await model.predict(imgupload, false);
      for (let i = 0; i < maxPredictions; i++) {
        const classPrediction =
          prediction[i].className + ": " + prediction[i].probability.toFixed(2);
        labelContainer.childNodes[i].innerHTML = classPrediction;
      }
      $(".removethis").hide();
    }
  
    // Load the image model and setup the webcam
    async function initweb() {
      const modelURL = URL + "model.json";
      const metadataURL = URL + "metadata.json";

      // load the model and metadata
      // Refer to tmImage.loadFromFiles() in the API to support files from a file picker
      // or files from your local hard drive
      // Note: the pose library adds "tmImage" object to your window (window.tmImage)
      model = await tmImage.load(modelURL, metadataURL);
      maxPredictions = model.getTotalClasses();

      // Convenience function to setup a webcam
      const flip = true; // whether to flip the webcam
      webcam = new tmImage.Webcam(200, 200, flip); // width, height, flip
      await webcam.setup(); // request access to the webcam
      await webcam.play();
      window.requestAnimationFrame(loop);

      // append elements to the DOM
      document.getElementById("webcam-container").appendChild(webcam.canvas);
      labelContainer = document.getElementById("label-container");
      for (let i = 0; i < maxPredictions; i++) { // and class labels
        labelContainer.appendChild(document.createElement("div"));
      }
    }
    async function loop() {
      webcam.update(); // update the webcam frame
      await predict();
      window.requestAnimationFrame(loop);
    }
    // run the webcam image through the image model
    async function predict() {
      // predict can take in an image, video or canvas html element
      const prediction = await model.predict(webcam.canvas);
      for (let i = 0; i < maxPredictions; i++) {
        const classPrediction =
          prediction[i].className + ": " + prediction[i].probability.toFixed(2);
        labelContainer.childNodes[i].innerHTML = classPrediction;
      }
    }
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
    crossorigin="anonymous"></script>
  <script type="text/javascript" src="/static/js/face.js"></script>
</body>
<!-- Copyright (c) 2021 by Aaron Vanston (https://codepen.io/aaronvanston/pen/yNYOXR)

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. -->

</html>